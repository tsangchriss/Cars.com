
SELECT company, COUNT(company) FROM car
GROUP BY company 
HAVING COUNT(company) >= 10000
ORDER BY COUNT(company) DESC
LIMIT 5; -- THE MOST POPULAR COMPANIES POSTED BY SELLERS FROM CARS.COM (FORD 1ST); 

SELECT MODEL, COUNT(MODEL) FROM CAR
WHERE COMPANY = 'Ford' 
GROUP BY MODEL
ORDER BY COUNT(MODEL) DESC; -- ON CARS.COM, THE MOST POPULAR FORD MODEL POSTED IS FUSION SE

SELECT MODEL, ROUND(AVG(PRICE), 2) FROM CAR
WHERE COMPANY = 'Ford' 
GROUP BY MODEL 
HAVING COUNT(*) > 2000
ORDER BY ROUND(AVG(PRICE), 2) DESC
LIMIT 5; -- THE AVERAGE PRICE OF THE FORD FUSION SE IS $17129.99, THE SECOND CHEAPEST MODEL OF THE FORD CARS. 

SELECT COMPANY, COUNT(COMPANY), ROUND(AVG(PRICE_DROP), 2) AS AVGERAGE_PRICE_DROP FROM CAR
GROUP BY COMPANY
HAVING COUNT(COMPANY) > 28000 
ORDER BY ROUND(AVG(PRICE_DROP), 2) DESC; -- HOWEVER, FORD CARS HAVE THE FOURTH HIGHEST AVERAGE DROP IN PRICE AT $520.85.  

SELECT COMPANY, SUM(ACCIDENTS) AS NUMBER_OF_ACCIDENTS FROM CAR
GROUP BY COMPANY
ORDER BY SUM(ACCIDENTS) DESC
LIMIT 5; -- IN ADDITION, IN TOTAL, FORD CARS HAVE EXPERIENCED ACCIDENTS AT LEAST ONCE, THE MOST TIMES.

SELECT COUNT(DISTINCT(exterior_color)) FROM car
WHERE company = 'Ford'; -- FORD HAS 1163 DISTINCT EXTERIOR COLOR NAMES

SELECT 
	SUM(CASE WHEN exterior_color ILIKE '%BLACK%' THEN 1
		ELSE 0
		END) AS BLACK,
	SUM(CASE WHEN exterior_color ILIKE '%WHITE%' THEN 1
		ELSE 0
		END) AS WHITE,
	SUM(CASE WHEN exterior_color ILIKE '%RED%' THEN 1
		ELSE 0
		END) AS RED,
	SUM(CASE WHEN exterior_color ILIKE '%BLUE%' THEN 1
		ELSE 0
		END) AS BLUE,
	SUM(CASE WHEN exterior_color ILIKE '%SILVER%' THEN 1
		ELSE 0
		END) AS SILVER,
	SUM(CASE WHEN exterior_color ILIKE '%GREEN%' THEN 1
		ELSE 0
		END) AS GREEN
FROM car; -- THE MOST POPULAR EXTERIOR COLOR ACROSS ALL COMPANIES IS WHITE.

SELECT 
	SUM(CASE WHEN exterior_color ILIKE '%BLACK%' AND company = 'Ford' THEN 1
		ELSE 0
		END) AS BLACK,
	SUM(CASE WHEN exterior_color ILIKE '%WHITE%' AND company = 'Ford' THEN 1
		ELSE 0
		END) AS WHITE,
	SUM(CASE WHEN exterior_color ILIKE '%RED%' AND company = 'Ford' THEN 1
		ELSE 0
		END) AS RED,
	SUM(CASE WHEN exterior_color ILIKE '%BLUE%' AND company = 'Ford' THEN 1
		ELSE 0
		END) AS BLUE,
	SUM(CASE WHEN exterior_color ILIKE '%SILVER%' AND company = 'Ford' THEN 1
		ELSE 0
		END) AS SILVER,
	SUM(CASE WHEN exterior_color ILIKE '%GREEN%' AND company = 'Ford' THEN 1
		ELSE 0
		END) AS GREEN
FROM car; -- THE MOST POPULAR EXTERIOR COLOR FOR FORD CARS IS ALSO WHITE. 

SELECT SELLER_NAME, SELLER_RATING, COUNT(*) AS NUMBER_CARS_POSTED FROM CAR
WHERE COMPANY = 'Ford' AND SELLER_NAME IS NOT NULL AND SELLER_RATING IS NOT NULL
GROUP BY SELLER_NAME, SELLER_RATING
ORDER BY COUNT(*) DESC, SELLER_RATING DESC
LIMIT 5; -- IF THE SELLER_NAME AND RATING IS NOT NULL, PACIFIC AUTO CENTER HAS POSTED THE MOST FORD CARS ON CARS.COM.  

SELECT YEAR AS CAR_MODEL_YEAR, COUNT(*) AS NUMBER_OF_FORD_CARS , ROUND(AVG(PRICE), 2) AS AVERAGE_PRICE FROM CAR
WHERE COMPANY = 'Ford'
GROUP BY YEAR
HAVING YEAR BETWEEN 2010 AND 2020
ORDER BY COUNT(*) DESC;

--TABLES FOR GRAPHS: 
SELECT company, COUNT(company) FROM car
GROUP BY company 
HAVING COUNT(company) >= 4000
ORDER BY COUNT(company) DESC
LIMIT 5;
--
SELECT COMPANY, FUEL, COUNT(FUEL) AS NUMBER_OF_CARS FROM CAR
WHERE COMPANY = 'Ford' OR COMPANY = 'Toyota' 
GROUP BY COMPANY, FUEL
HAVING FUEL = 'Gasoline' OR FUEL = 'Hybrid' 
ORDER BY COUNT(FUEL) DESC;
--
SELECT YEAR, ROUND(AVG(PRICE_DROP), 2) AS AVERAGE_PRICE_DROP, ROUND(AVG(PRICE), 2) AS AVERAGE_PRICE FROM CAR
WHERE COMPANY = 'Ford' AND YEAR = 2017 OR YEAR = 2018 OR YEAR = 2019 
OR YEAR = 2020 OR YEAR = 2021 OR YEAR = 2022
GROUP BY YEAR;
--
SELECT SELLER_NAME, SELLER_RATING, ROUND(PRICE, 2) AS PRICE_PLUS_DROP FROM CAR
WHERE COMPANY = 'Ford' AND SELLER_RATING IN (SELECT COALESCE(SELLER_RATING, 0) 
											 FROM CAR)
AND PRICE IN (SELECT PRICE + COALESCE(PRICE_DROP, 0)) 
GROUP BY SELLER_NAME, SELLER_RATING, PRICE
ORDER BY PRICE DESC;

SELECT CORR(SELLER_RATING, PRICE) AS CORRELATION FROM CAR
WHERE COMPANY = 'Ford'
AND SELLER_RATING IN (SELECT COALESCE(SELLER_RATING, 0) 
						FROM CAR) 
AND PRICE IN (SELECT COALESCE(PRICE, 0) + COALESCE(PRICE_DROP,0) 
			  FROM CAR);
--
SELECT YEAR, DRIVETRAIN, SUM(PRICE) FROM CAR         
WHERE COMPANY = 'Ford' AND YEAR = 2018 
OR YEAR = 2019 OR YEAR = 2020 OR YEAR = 2021 OR YEAR = 2022
GROUP BY YEAR, DRIVETRAIN
HAVING COUNT(DRIVETRAIN) > 600
ORDER BY YEAR, DRIVETRAIN; -- CHECK COUNT OF DRIVETRAIN = 'FOUR WHEEL DRIVE'!
---
SELECT COMPANY, YEAR, ROUND(AVG(PRICE), 2) FROM CAR
WHERE COMPANY = 'Ford' OR COMPANY = 'Toyota' OR COMPANY='Jeep' OR COMPANY = 'Nissan' OR COMPANY = 'CHEVROLET' 
GROUP BY COMPANY, YEAR
HAVING YEAR BETWEEN 2015 AND 2020;
---




































